var awsMetrics={dataStructureVersion:'0.2',isEnabled:true,initConfig:function(awsRegion,identityPoolId,streamName,hashedSessionId,hashedUserId,userType,env,application,tenant){AWS.config.region=awsRegion;AWS.config.credentials=new AWS.CognitoIdentityCredentials({IdentityPoolId:identityPoolId});awsMetrics.streamName=streamName;awsMetrics.userType=userType;awsMetrics.env=env;awsMetrics.application=application;awsMetrics.tenant=tenant;awsMetrics.sessionId=hashedSessionId;awsMetrics.userId=hashedUserId;},logData:function(actionPerformed,eventName,additionalData){var awsMetricsData={};awsMetricsData.dataStructureVersion=awsMetrics.dataStructureVersion;awsMetricsData.eventName=eventName;awsMetricsData.actionPerformed=actionPerformed;var currentDate=new Date();awsMetricsData.eventTime=currentDate.getTime();awsMetricsData.timezoneOffset=generateTimezoneOffset(currentDate);awsMetricsData.env=awsMetrics.env;awsMetricsData.application=awsMetrics.application;awsMetricsData.tenant=awsMetrics.tenant;awsMetricsData.pageURL=window.location.href;awsMetricsData.referrer=document.referrer;awsMetricsData.sessionId=awsMetrics.sessionId;awsMetricsData.userId=awsMetrics.userId;awsMetricsData.userType=awsMetrics.userType;awsMetricsData.additionalData=typeof additionalData==='string'?JSON.parse(additionalData):additionalData;var params={DeliveryStreamName:awsMetrics.streamName,Record:{Data:JSON.stringify(awsMetricsData)}};AWS.config.credentials.get(function(err){if(err){console.error('Error retrieving AWS credentials: '+err);return;}
var firehose=new AWS.Firehose({apiVersion:'2015-08-04'});firehose.putRecord(params,function(err,data){if(err){console.log(err,err.stack);}});});}};function generateTimezoneOffset(date){var offsetInHours=date.getTimezoneOffset()/60;if(Math.sign(offsetInHours)===1){return"GMT-"+offsetInHours;}else{return"GMT+"+Math.abs(offsetInHours);}}
console.debug('AWS Metrics logging is enabled.');